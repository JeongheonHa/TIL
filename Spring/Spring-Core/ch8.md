# 빈 생명주기 콜백
애플리케이션 시작 시점에 필요한 연결을 미리 해두고, 애플리케이션 종료 시점에 연결을 모두 종료하는 작업을 진행하려면, 객체의 초기화와 종료 작업이 필요하다.

## 1. 스프링 빈의 이벤트 라이프 사이클 (싱글톤의 경우)
스프링 컨테이너 생성 -> 스프링 빈 생성 -> 의존관계 주입 -> 초기화 콜백 -> 사용 -> 소멸전 콜백 -> 스프링 종료
- 초기화 콜백: 빈이 생성되고, 빈의 의존관계 주입이 완료된 후 호출
- 소멸전 콜백: 빈이 소멸되기 직전에 호출
- 스프링은 의존관계 주입이 완료되면 스프링 빈에게 콜백 메서드를 통해서 초기화 시점을 알려주는 다양한 기능을 제공한다.
- 스프링은 스프링 컨테이너가 종료되기 직전에 소멸 콜백을 준다.

### 객체의 생성과 초기화는 분리하는게 좋다.
생성자: 필수 정보를 받고, 메모리를 할당해서 객체를 생성하는 책임을 갖는다.
초기화: 생성된 값들을 활용해서 외부 커넥션을 연결하는 것과 같은 무거운 동작을 수행한다.

## 2. 스프링이 지원하는 3가지 빈 생성주기 콜백
- 인터페이스 (사용 안함)
- 설정 정보에 초기화 메서드, 종료 메서드 지정
- @PostConstruct, @PreDestory 애너테이션 지원 (가장 많이 사용)

### 2.1 인터페이스
- InitializingBean: afterPropertiesSet()메서드로 초기화 지원
- DisposableBean: destroy()메서드로 소멸을 지원
- 클래스에 두 인터페이스를 상속받아 두 메서드를 오버라이딩해서 사용한다.

#### 단점
- 스프링 전용 인터페이스로 해당 코드가 스프링 전용 인터페이스에 의존하게 되는데 코드 level에서 스프링의 인터페이스를 가져오는 것은 부담된다. (애너테이션 정도는 괜찮다.)
- 초기화, 소멸 메서드의 이름 변경 x
- 코드를 고칠 수 없는 외부 라이브러리에 적용할 수 없다.

### 2.2 빈 등록 초기화, 소멸 메서드 지정
설정 정보에 초기화 소멸 메서드를 지정함으로써 생성주기를 콜백한다.
```java
@Bean(initMethod = "init", destroyMethod = "close")
```
- 소멸 메서드는 생략 가능

#### 특징
- 메서드 이름을 자유롭게 변경 가능
- 스프링 빈이 스프링 코드에 의존하지 않는다.
- 코드를 고칠 수 없는 외부 라이브러리에도 사용 가능

### 2.3 @PostConstruct, @PreDestory
- @PostConstruct: 초기화 메서드에 사용한다.
- @PreDestory:: 소멸 메서드에 사용한다.

#### 특징
- 자바 표준 기술로 스프링이 아닌 다른 컨테이너에서도 동작한다.
- 컴포넌트 스캔과 잘 어울린다.
- 다만, 외부 라이브러리에는 적용하지 못한다. 
- 따라서, 대부분 해당 기술을 사용하고 외부 라이브러리를 초기화, 종료 해야하는 경우에만 @Bean(initMethod = "~")을 사용하도록 하자.

## Reference
> 스프링 핵심 원리 - 기본편 [김영한]
